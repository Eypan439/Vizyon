<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vizyon Kitap ve Film KulÃ¼bÃ¼ ðŸ“–ðŸŽ¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f5ff;
        }
        .movie-card, .book-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .movie-card:hover, .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .tab-active {
            border-bottom: 3px solid #6d28d9;
            color: #6d28d9;
            font-weight: 600;
        }
        .rating-star {
            cursor: pointer;
            transition: transform 0.2s;
        }
        .rating-star:hover {
            transform: scale(1.2);
        }
        .book-image {
            transition: transform 0.5s ease;
            height: 280px;
            object-fit: cover;
        }
        .book-image:hover {
            transform: scale(1.05);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #6d28d9 0%, #8b5cf6 100%);
        }
        .film-details, .book-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }
        .film-details.active, .book-details.active {
            max-height: 2000px; /* Large enough to show all content */
        }
        .loader {
            border-top-color: #6d28d9;
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }
        @-webkit-keyframes spinner {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .update-btn {
            transition: all 0.3s ease;
        }
        .update-btn:hover {
            transform: translateY(-2px);
        }
        .verified-badge {
            width: 20px;
            height: 20px;
            margin-left: 4px;
            display: inline-block;
            vertical-align: middle;
        }
        .featured-comment {
            border-left: 4px solid #8b5cf6;
            background-color: #f3f0ff;
        }
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal-active {
            overflow-x: hidden;
            overflow-y: visible !important;
        }
        .rating-input label {
            cursor: pointer;
        }
        .rating-input input {
            display: none;
        }
        .rating-input label svg {
            width: 25px;
            height: 25px;
            transition: all 0.2s ease;
        }
        .rating-input label svg.filled {
            fill: #fbbf24;
        }
        .rating-input label svg.empty {
            fill: none;
        }
        .welcome-screen {
            background: linear-gradient(135deg, #6d28d9 0%, #8b5cf6 100%);
            min-height: 100vh;
        }
        .welcome-card {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            width: 90%;
        }
        .welcome-card img {
            max-width: 150px;
        }
        .welcome-btn {
            transition: all 0.3s ease;
        }
        .welcome-btn:hover {
            transform: translateY(-3px);
        }
        .book-card {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .book-card-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .book-actions {
            margin-top: auto;
        }
        .pdf-download-btn {
            transition: all 0.3s ease;
        }
        .pdf-download-btn:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- Welcome Screen (Shown first) -->
    <div id="welcome-screen" class="welcome-screen flex items-center justify-center">
        <div class="welcome-card p-8 flex flex-col items-center">
            <div class="mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h18M3 16h18" />
                </svg>
            </div>
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">Vizyon Kitap ve Film KulÃ¼bÃ¼</h1>
            <p class="text-gray-600 text-center mb-8">Kitap ve film tutkunlarÄ± iÃ§in Ã¶zel bir platform</p>
            <div class="flex flex-col w-full space-y-4">
                <button id="welcome-login-btn" class="welcome-btn bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-md">
                    GiriÅŸ Yap
                </button>
                <button id="welcome-register-btn" class="welcome-btn bg-white hover:bg-gray-100 text-purple-600 font-bold py-3 px-6 rounded-lg border border-purple-600 shadow-md">
                    KayÄ±t Ol
                </button>
                <button id="welcome-guest-btn" class="text-gray-500 hover:text-gray-700 font-medium py-2">
                    Misafir olarak devam et
                </button>
            </div>
        </div>
    </div>

    <div id="main-app" class="min-h-screen flex flex-col hidden">
        <!-- Header -->
        <header class="gradient-bg text-white shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="flex items-center mb-4 md:mb-0">
                        <div class="text-3xl font-bold flex items-center">
                            <span>Vizyon Kitap ve Film KulÃ¼bÃ¼</span>
                            <span class="ml-2 text-2xl">ðŸ“–ðŸŽ¬</span>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex space-x-4">
                            <button id="btn-films" class="px-4 py-2 rounded-lg bg-white text-purple-700 font-medium hover:bg-purple-100 transition">Filmler</button>
                            <button id="btn-books" class="px-4 py-2 rounded-lg bg-white text-purple-700 font-medium hover:bg-purple-100 transition">Kitaplar</button>
                            <button id="btn-music" class="px-4 py-2 rounded-lg bg-white text-purple-700 font-medium hover:bg-purple-100 transition">MÃ¼zik</button>
                        </div>
                        <!-- User Menu (Logged out state) -->
                        <div id="user-logged-out" class="flex space-x-2">
                            <button id="btn-login" class="px-4 py-2 rounded-lg bg-purple-600 text-white font-medium hover:bg-purple-700 transition">GiriÅŸ Yap</button>
                            <button id="btn-register" class="px-4 py-2 rounded-lg bg-white text-purple-700 border border-purple-700 font-medium hover:bg-purple-50 transition">KayÄ±t Ol</button>
                        </div>
                        <!-- User Menu (Logged in state) -->
                        <div id="user-logged-in" class="hidden relative">
                            <button id="user-menu-button" class="flex items-center space-x-2 px-4 py-2 rounded-lg bg-purple-700 text-white font-medium hover:bg-purple-800 transition">
                                <span id="user-name-display">KullanÄ±cÄ±</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                            </button>
                            <div id="user-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10">
                                <a href="#" id="btn-profile" class="block px-4 py-2 text-sm text-gray-700 hover:bg-purple-100">Profilim</a>
                                <a href="#" id="btn-admin-panel" class="hidden block px-4 py-2 text-sm text-gray-700 hover:bg-purple-100">Admin Paneli</a>
                                <a href="#" id="btn-logout" class="block px-4 py-2 text-sm text-gray-700 hover:bg-purple-100">Ã‡Ä±kÄ±ÅŸ Yap</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Loading Indicator -->
        <div id="loading" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
            <div class="bg-white p-5 rounded-lg flex flex-col items-center">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"></div>
                <h2 class="text-center text-gray-800 text-xl font-semibold">YÃ¼kleniyor...</h2>
                <p class="w-full text-center text-gray-600">Veriler getiriliyor, lÃ¼tfen bekleyin.</p>
            </div>
        </div>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-8">
            <!-- Films Section -->
            <section id="films-section" class="mb-12">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Film KulÃ¼bÃ¼</h2>
                    <div class="flex space-x-2">
                        <button id="add-film-btn" class="admin-only hidden px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                            Film Ekle
                        </button>
                    </div>
                </div>

                <!-- Film Tabs -->
                <div class="mb-6 border-b border-gray-200">
                    <div class="flex overflow-x-auto" id="film-tabs">
                        <button class="film-tab tab-active px-6 py-3 text-gray-700 whitespace-nowrap" data-tab="all">TÃ¼m Filmler</button>
                        <!-- Film tabs will be dynamically inserted here -->
                    </div>
                </div>

                <!-- Film Cards -->
                <div class="space-y-8" id="film-cards">
                    <!-- Film cards will be dynamically inserted here -->
                </div>
            </section>

            <!-- Books Section (Hidden by default) -->
            <section id="books-section" class="mb-12 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Kitap KulÃ¼bÃ¼</h2>
                    <button id="add-book-btn" class="admin-only hidden px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                        </svg>
                        Kitap Ekle
                    </button>
                </div>

                <!-- Book Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="book-cards">
                    <!-- Book cards will be dynamically inserted here -->
                </div>
            </section>

            <!-- Music Section (Hidden by default) -->
            <section id="music-section" class="mb-12 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">MÃ¼zik KÃ¶ÅŸesi</h2>
                </div>

                <div class="bg-gradient-to-r from-purple-500 to-indigo-600 rounded-xl shadow-lg overflow-hidden text-white">
                    <div class="p-8">
                        <h3 class="text-2xl font-bold mb-4">Vizyon Playlist</h3>
                        <p class="mb-6">Vizyon rengarenk insanlardan oluÅŸan bir topluluk ve neden bu rengarenk zevklerden oluÅŸan bir playlistimiz olmasÄ±n? Sen de bir renk katmayÄ± unutma!</p>
                        <a href="https://open.spotify.com/playlist/1tGeLgECLa3lDx3X1DYzlN?si=5kI9UGfaRLu7GE0lcPcM9Q" target="_blank" class="inline-flex items-center px-6 py-3 bg-white text-purple-700 rounded-lg font-medium hover:bg-gray-100 transition">
                            <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/>
                            </svg>
                            Spotify Playlist'e Git
                        </a>
                    </div>
                </div>
            </section>

            <!-- Profile Section (Hidden by default) -->
            <section id="profile-section" class="mb-12 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Profilim</h2>
                </div>

                <div class="bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="md:flex">
                        <div class="md:flex-shrink-0">
                            <div class="h-64 w-full md:w-48 bg-purple-100 flex items-center justify-center overflow-hidden">
                                <img id="profile-image" class="h-full w-full object-cover" src="" alt="Profil Resmi">
                            </div>
                        </div>
                        <div class="p-8">
                            <div class="uppercase tracking-wide text-sm text-purple-600 font-semibold">KullanÄ±cÄ± Bilgileri</div>
                            <h3 id="profile-name" class="mt-1 text-xl font-semibold text-gray-900"></h3>
                            <p id="profile-email" class="mt-2 text-gray-600"></p>
                            <p id="profile-gender" class="mt-2 text-gray-600"></p>
                            <p id="profile-age" class="mt-2 text-gray-600"></p>
                            <p id="profile-date" class="mt-2 text-gray-600"></p>
                        </div>
                    </div>
                </div>

                <div class="mt-8">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">YorumlarÄ±m</h3>
                    <div class="space-y-4" id="user-comments">
                        <!-- User comments will be dynamically inserted here -->
                    </div>
                </div>
            </section>

            <!-- Admin Panel Section (Hidden by default) -->
            <section id="admin-section" class="mb-12 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Admin Paneli</h2>
                </div>

                <div class="bg-white rounded-xl shadow-md overflow-hidden mb-8">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">KullanÄ±cÄ±lar</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ad Soyad</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cinsiyet</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">YaÅŸ</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rol</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ä°ÅŸlemler</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-users-table" class="bg-white divide-y divide-gray-200">
                                    <!-- Users will be dynamically inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-md overflow-hidden">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">TÃ¼m Yorumlar</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">KullanÄ±cÄ±</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ä°Ã§erik</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Puan</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Yorum</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tarih</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mavi Tik</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ä°ÅŸlemler</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-comments-table" class="bg-white divide-y divide-gray-200">
                                    <!-- Comments will be dynamically inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-6">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <p>Â© 2023 Vizyon Kitap ve Film KulÃ¼bÃ¼</p>
                    </div>
                    <div class="flex space-x-4">
                        <a href="#" class="hover:text-purple-400 transition">HakkÄ±mÄ±zda</a>
                        <a href="#" class="hover:text-purple-400 transition">Ä°letiÅŸim</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
        
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold">GiriÅŸ Yap</p>
                    <div class="modal-close cursor-pointer z-50">
                        <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                            <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                        </svg>
                    </div>
                </div>

                <form id="login-form">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="login-email">
                            Email
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="login-email" type="email" placeholder="Email" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="login-password">
                            Åžifre
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="login-password" type="password" placeholder="******************" required>
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            GiriÅŸ Yap
                        </button>
                        <a class="inline-block align-baseline font-bold text-sm text-purple-600 hover:text-purple-800" href="#" id="forgot-password-link">
                            Åžifremi Unuttum
                        </a>
                    </div>
                    <div id="login-error" class="text-red-500 text-sm mt-4 hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
        
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold">KayÄ±t Ol</p>
                    <div class="modal-close cursor-pointer z-50">
                        <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                            <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                        </svg>
                    </div>
                </div>

                <form id="register-form">
                    <div class="mb-4 flex space-x-4">
                        <div class="w-1/2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="register-firstname">
                                Ad
                            </label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="register-firstname" type="text" placeholder="Ad" required>
                        </div>
                        <div class="w-1/2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="register-lastname">
                                Soyad
                            </label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="register-lastname" type="text" placeholder="Soyad" required>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="register-email">
                            Email
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="register-email" type="email" placeholder="Email" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="register-password">
                            Åžifre
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="register-password" type="password" placeholder="******************" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="register-age">
                            YaÅŸ
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="register-age" type="number" min="13" max="120" placeholder="YaÅŸ" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="register-gender">
                            Cinsiyet
                        </label>
                        <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="register-gender" required>
                            <option value="">SeÃ§iniz</option>
                            <option value="Erkek">Erkek</option>
                            <option value="KadÄ±n">KadÄ±n</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            KayÄ±t Ol
                        </button>
                    </div>
                    <div id="register-error" class="text-red-500 text-sm mt-4 hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Comment Modal -->
    <div id="comment-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
        
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold" id="comment-modal-title">Yorum Ekle</p>
                    <div class="modal-close cursor-pointer z-50">
                        <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                            <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                        </svg>
                    </div>
                </div>

                <form id="comment-form">
                    <input type="hidden" id="comment-content-id" value="">
                    <input type="hidden" id="comment-content-title" value="">
                    <input type="hidden" id="comment-content-type" value="">
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                            Ä°zlediniz mi / Okudunuz mu?
                        </label>
                        <div class="flex items-center">
                            <input type="checkbox" id="comment-watched" class="mr-2">
                            <label for="comment-watched">Evet</label>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                            PuanÄ±nÄ±z
                        </label>
                        <div class="rating-input flex space-x-1">
                            <input type="radio" name="rating" id="rating-1" value="1">
                            <label for="rating-1">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-2" value="2">
                            <label for="rating-2">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-3" value="3">
                            <label for="rating-3">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-4" value="4">
                            <label for="rating-4">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-5" value="5" checked>
                            <label for="rating-5">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-6" value="6">
                            <label for="rating-6">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-7" value="7">
                            <label for="rating-7">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-8" value="8">
                            <label for="rating-8">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-9" value="9">
                            <label for="rating-9">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                            <input type="radio" name="rating" id="rating-10" value="10">
                            <label for="rating-10">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star empty">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                            </label>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="comment-text">
                            Yorumunuz
                        </label>
                        <textarea class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="comment-text" rows="4" placeholder="Yorumunuzu buraya yazÄ±n"></textarea>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <button class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            GÃ¶nder
                        </button>
                    </div>
                    <div id="comment-error" class="text-red-500 text-sm mt-4 hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Film Modal -->
    <div id="add-film-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
        
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold">Film Ekle</p>
                    <div class="modal-close cursor-pointer z-50">
                        <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                            <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                        </svg>
                    </div>
                </div>

                <form id="add-film-form">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="film-name">
                            Film AdÄ±
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="film-name" type="text" placeholder="Film AdÄ±" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="film-year">
                            YayÄ±n YÄ±lÄ±
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="film-year" type="text" placeholder="YayÄ±n YÄ±lÄ±">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="film-image">
                            Resim URL
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="film-image" type="text" placeholder="Resim URL">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="film-date-range">
                            Tarih AralÄ±ÄŸÄ±
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="film-date-range" type="text" placeholder="Ã–rn: 21â€“25 Temmuz">
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            Ekle
                        </button>
                    </div>
                    <div id="add-film-error" class="text-red-500 text-sm mt-4 hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Book Modal -->
    <div id="add-book-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
        
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold">Kitap Ekle</p>
                    <div class="modal-close cursor-pointer z-50">
                        <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                            <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                        </svg>
                    </div>
                </div>

                <form id="add-book-form">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="book-name">
                            Kitap AdÄ±
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="book-name" type="text" placeholder="Kitap AdÄ±" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="book-author">
                            Yazar
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="book-author" type="text" placeholder="Yazar">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="book-image">
                            Resim URL
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="book-image" type="text" placeholder="Resim URL">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="book-pdf">
                            PDF URL (Ä°steÄŸe baÄŸlÄ±)
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="book-pdf" type="text" placeholder="PDF URL">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="book-date-range">
                            Tarih AralÄ±ÄŸÄ±
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="book-date-range" type="text" placeholder="Ã–rn: Temmuzun son haftasÄ±">
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            Ekle
                        </button>
                    </div>
                    <div id="add-book-error" class="text-red-500 text-sm mt-4 hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        // Firebase yapÄ±landÄ±rmasÄ±
        const firebaseConfig = {
            apiKey: "AIzaSyD3i3UYYvAiGiEpM14SXbVTd9U9jk1BO58",
            authDomain: "vizyon-da2dd.firebaseapp.com",
            projectId: "vizyon-da2dd",
            storageBucket: "vizyon-da2dd.firebasestorage.app",
            messagingSenderId: "801926636810",
            appId: "1:801926636810:web:f0789b9ef104c7338e86f3",
            measurementId: "G-M97R718RT1"
        };

        // Firebase'i baÅŸlat
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // DOM elementleri
        const welcomeScreen = document.getElementById('welcome-screen');
        const mainApp = document.getElementById('main-app');
        const loadingIndicator = document.getElementById('loading');
        const userLoggedOut = document.getElementById('user-logged-out');
        const userLoggedIn = document.getElementById('user-logged-in');
        const userNameDisplay = document.getElementById('user-name-display');
        const userDropdown = document.getElementById('user-dropdown');
        const btnAdminPanel = document.getElementById('btn-admin-panel');
        const adminElements = document.querySelectorAll('.admin-only');
        
        const btnFilms = document.getElementById('btn-films');
        const btnBooks = document.getElementById('btn-books');
        const btnMusic = document.getElementById('btn-music');
        const btnProfile = document.getElementById('btn-profile');
        const btnLogin = document.getElementById('btn-login');
        const btnRegister = document.getElementById('btn-register');
        const btnLogout = document.getElementById('btn-logout');
        const btnAddFilm = document.getElementById('add-film-btn');
        const btnAddBook = document.getElementById('add-book-btn');
        
        const welcomeLoginBtn = document.getElementById('welcome-login-btn');
        const welcomeRegisterBtn = document.getElementById('welcome-register-btn');
        const welcomeGuestBtn = document.getElementById('welcome-guest-btn');
        
        const filmsSection = document.getElementById('films-section');
        const booksSection = document.getElementById('books-section');
        const musicSection = document.getElementById('music-section');
        const profileSection = document.getElementById('profile-section');
        const adminSection = document.getElementById('admin-section');
        
        const filmTabsContainer = document.getElementById('film-tabs');
        const filmCardsContainer = document.getElementById('film-cards');
        const bookCardsContainer = document.getElementById('book-cards');
        
        // Modal elementleri
        const loginModal = document.getElementById('login-modal');
        const registerModal = document.getElementById('register-modal');
        const commentModal = document.getElementById('comment-modal');
        const addFilmModal = document.getElementById('add-film-modal');
        const addBookModal = document.getElementById('add-book-modal');
        
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const commentForm = document.getElementById('comment-form');
        const addFilmForm = document.getElementById('add-film-form');
        const addBookForm = document.getElementById('add-book-form');

        // Global deÄŸiÅŸkenler
        let currentUser = null;
        let isAdmin = false;
        let dataLoaded = false;
        let contents = [];
        let comments = [];
        let users = [];

        // Default profil resimleri
        const defaultMaleImage = "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png";
        const defaultFemaleImage = "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png";
        const verifiedBadgeUrl = "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Twitter_Verified_Badge.svg/2048px-Twitter_Verified_Badge.svg.png";

        // Sayfa yÃ¼klendiÄŸinde
        document.addEventListener('DOMContentLoaded', () => {
            setupEventListeners();
            
            // Firebase Auth durumunu dinle
            auth.onAuthStateChanged(user => {
                if (user) {
                    // KullanÄ±cÄ± giriÅŸ yapmÄ±ÅŸ
                    fetchUserData(user.uid);
                } else {
                    // KullanÄ±cÄ± Ã§Ä±kÄ±ÅŸ yapmÄ±ÅŸ
                    currentUser = null;
                    isAdmin = false;
                    
                    // Welcome screen'i gÃ¶ster
                    welcomeScreen.classList.remove('hidden');
                    mainApp.classList.add('hidden');
                    
                    // KullanÄ±cÄ± menÃ¼sÃ¼nÃ¼ gÃ¼ncelle
                    userLoggedIn.classList.add('hidden');
                    userLoggedOut.classList.remove('hidden');
                    userDropdown.classList.add('hidden');
                }
            });
        });

        // KullanÄ±cÄ± verilerini getir
        function fetchUserData(userId) {
            showLoading();
            
            db.collection('users').doc(userId).get()
                .then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        
                        currentUser = {
                            id: userId,
                            name: `${userData.ad} ${userData.soyad}`,
                            email: userData.email,
                            role: userData.role || 'user',
                            gender: userData.cinsiyet,
                            age: userData.yas,
                            createdAt: userData.createdAt
                        };
                        
                        isAdmin = currentUser.role === 'admin';
                        
                        showMainApp();
                    } else {
                        console.error("KullanÄ±cÄ± verisi bulunamadÄ±");
                        auth.signOut(); // KullanÄ±cÄ± verisi yoksa Ã§Ä±kÄ±ÅŸ yap
                    }
                    
                    hideLoading();
                })
                .catch(error => {
                    console.error("KullanÄ±cÄ± verisi getirme hatasÄ±:", error);
                    hideLoading();
                });
        }

        // Event listener'larÄ± ayarla
        function setupEventListeners() {
            // Welcome screen butonlarÄ±
            welcomeLoginBtn.addEventListener('click', () => {
                showModal('login-modal');
            });
            
            welcomeRegisterBtn.addEventListener('click', () => {
                showModal('register-modal');
            });
            
            welcomeGuestBtn.addEventListener('click', () => {
                loginAsGuest();
            });
            
            // Header butonlarÄ±
            btnFilms.addEventListener('click', () => {
                switchSection('films');
            });
            
            btnBooks.addEventListener('click', () => {
                switchSection('books');
            });
            
            btnMusic.addEventListener('click', () => {
                switchSection('music');
            });
            
            btnProfile.addEventListener('click', () => {
                switchSection('profile');
                renderUserProfile();
            });
            
            btnAdminPanel.addEventListener('click', () => {
                switchSection('admin');
                renderAdminPanel();
            });
            
            btnLogin.addEventListener('click', () => {
                showModal('login-modal');
            });
            
            btnRegister.addEventListener('click', () => {
                showModal('register-modal');
            });
            
            btnLogout.addEventListener('click', () => {
                logout();
            });
            
            // Film ve kitap ekleme butonlarÄ±
            btnAddFilm.addEventListener('click', () => {
                showModal('add-film-modal');
            });
            
            btnAddBook.addEventListener('click', () => {
                showModal('add-book-modal');
            });
            
            // User menu dropdown
            document.getElementById('user-menu-button').addEventListener('click', () => {
                userDropdown.classList.toggle('hidden');
            });
            
            // Modal close butonlarÄ±
            document.querySelectorAll('.modal-close').forEach(button => {
                button.addEventListener('click', () => {
                    const modal = button.closest('.modal');
                    hideModal(modal.id);
                });
            });
            
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', () => {
                    const modal = overlay.closest('.modal');
                    hideModal(modal.id);
                });
            });
            
            // Form submit olaylarÄ±
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                login(email, password);
            });
            
            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const firstName = document.getElementById('register-firstname').value;
                const lastName = document.getElementById('register-lastname').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const age = document.getElementById('register-age').value;
                const gender = document.getElementById('register-gender').value;
                
                register(firstName, lastName, email, password, age, gender);
            });
            
            commentForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const contentId = document.getElementById('comment-content-id').value;
                const contentTitle = document.getElementById('comment-content-title').value;
                const contentType = document.getElementById('comment-content-type').value;
                const rating = document.querySelector('input[name="rating"]:checked').value;
                const comment = document.getElementById('comment-text').value;
                const watched = document.getElementById('comment-watched').checked;
                
                addComment(contentId, contentTitle, contentType, rating, comment, watched);
            });
            
            // Film ekleme formu
            addFilmForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('film-name').value;
                const year = document.getElementById('film-year').value;
                const image = document.getElementById('film-image').value;
                const dateRange = document.getElementById('film-date-range').value;
                
                addFilm(name, year, image, dateRange);
            });
            
            // Kitap ekleme formu
            addBookForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('book-name').value;
                const author = document.getElementById('book-author').value;
                const image = document.getElementById('book-image').value;
                const pdfUrl = document.getElementById('book-pdf').value;
                const dateRange = document.getElementById('book-date-range').value;
                
                addBook(name, author, image, dateRange, pdfUrl);
            });
            
            // Film tabs event listener
            filmTabsContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('film-tab')) {
                    filterFilms(e.target);
                }
            });
            
            // YÄ±ldÄ±z derecelendirme sistemi
            document.querySelectorAll('.rating-input label').forEach(label => {
                label.addEventListener('click', () => {
                    const rating = label.getAttribute('for').split('-')[1];
                    updateStarRating(rating);
                });
            });
        }

        // GiriÅŸ yap
        function login(email, password) {
            showLoading();
            
            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    hideModal('login-modal');
                })
                .catch(error => {
                    document.getElementById('login-error').textContent = error.message;
                    document.getElementById('login-error').classList.remove('hidden');
                    hideLoading();
                });
        }

        // KayÄ±t ol
        function register(firstName, lastName, email, password, age, gender) {
            showLoading();
            
            auth.createUserWithEmailAndPassword(email, password)
                .then(userCredential => {
                    const user = userCredential.user;
                    
                    // KullanÄ±cÄ± verilerini Firestore'a kaydet
                    return db.collection('users').doc(user.uid).set({
                        ad: firstName,
                        soyad: lastName,
                        email: email,
                        yas: parseInt(age),
                        cinsiyet: gender,
                        role: 'user',
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                })
                .then(() => {
                    hideModal('register-modal');
                })
                .catch(error => {
                    document.getElementById('register-error').textContent = error.message;
                    document.getElementById('register-error').classList.remove('hidden');
                    hideLoading();
                });
        }

        // Misafir giriÅŸi
        function loginAsGuest() {
            showLoading();
            
            auth.signInAnonymously()
                .then(() => {
                    // Anonim kullanÄ±cÄ± iÃ§in Firestore'da veri oluÅŸtur
                    const user = auth.currentUser;
                    
                    return db.collection('users').doc(user.uid).set({
                        ad: 'Misafir',
                        soyad: 'KullanÄ±cÄ±',
                        email: 'misafir@example.com',
                        role: 'guest',
                        isGuest: true,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                })
                .catch(error => {
                    console.error("Misafir giriÅŸi hatasÄ±:", error);
                    hideLoading();
                });
        }

        // Ã‡Ä±kÄ±ÅŸ yap
        function logout() {
            auth.signOut()
                .catch(error => {
                    console.error("Ã‡Ä±kÄ±ÅŸ yapma hatasÄ±:", error);
                });
        }

        // Ana uygulamayÄ± gÃ¶ster
        function showMainApp() {
            welcomeScreen.classList.add('hidden');
            mainApp.classList.remove('hidden');
            
            // KullanÄ±cÄ± menÃ¼sÃ¼nÃ¼ gÃ¼ncelle
            if (currentUser) {
                userNameDisplay.textContent = currentUser.name;
                userLoggedOut.classList.add('hidden');
                userLoggedIn.classList.remove('hidden');
                
                // Admin paneli butonunu gÃ¶ster/gizle
                if (isAdmin) {
                    btnAdminPanel.classList.remove('hidden');
                    adminElements.forEach(el => el.classList.remove('hidden'));
                } else {
                    btnAdminPanel.classList.add('hidden');
                    adminElements.forEach(el => el.classList.add('hidden'));
                }
            }
            
            // Verileri yÃ¼kle
            loadData();
        }

        // Verileri yÃ¼kle
        function loadData() {
            showLoading();
            
            // Ä°Ã§erikleri yÃ¼kle
            Promise.all([
                db.collection('icerikler').where('tur', '==', 'film').get(),
                db.collection('icerikler').where('tur', '==', 'kitap').get(),
                db.collection('yorumlar').get(),
                db.collection('users').get()
            ])
            .then(([filmsSnapshot, booksSnapshot, commentsSnapshot, usersSnapshot]) => {
                // Filmleri yÃ¼kle
                contents = [];
                filmsSnapshot.forEach(doc => {
                    contents.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // KitaplarÄ± yÃ¼kle
                booksSnapshot.forEach(doc => {
                    contents.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                // YorumlarÄ± yÃ¼kle
                comments = [];
                commentsSnapshot.forEach(doc => {
                    // Timestamp'i Date nesnesine dÃ¶nÃ¼ÅŸtÃ¼r
                    const data = doc.data();
                    if (data.timestamp) {
                        data.timestamp = data.timestamp.toDate();
                    }
                    
                    comments.push({
                        id: doc.id,
                        ...data
                    });
                });
                
                // KullanÄ±cÄ±larÄ± yÃ¼kle
                users = [];
                usersSnapshot.forEach(doc => {
                    // Timestamp'i Date nesnesine dÃ¶nÃ¼ÅŸtÃ¼r
                    const data = doc.data();
                    if (data.createdAt) {
                        data.createdAt = data.createdAt.toDate();
                    }
                    
                    users.push({
                        id: doc.id,
                        ...data
                    });
                });
                
                console.log("YÃ¼klenen iÃ§erikler:", contents);
                console.log("YÃ¼klenen yorumlar:", comments);
                console.log("YÃ¼klenen kullanÄ±cÄ±lar:", users);
                
                renderFilmTabs();
                renderFilms();
                renderBooks();
                
                dataLoaded = true;
                hideLoading();
            })
            .catch(error => {
                console.error("Veri yÃ¼kleme hatasÄ±:", error);
                hideLoading();
            });
        }

        // Film sekmelerini render et
        function renderFilmTabs() {
            // Ä°lk sekme (TÃ¼m Filmler) dÄ±ÅŸÄ±ndaki sekmeleri temizle
            const allFilmsTab = filmTabsContainer.querySelector('[data-tab="all"]');
            filmTabsContainer.innerHTML = '';
            filmTabsContainer.appendChild(allFilmsTab);
            
            // Film tÃ¼rlerine gÃ¶re sekme oluÅŸtur
            const films = contents.filter(content => content.tur === "film");
            
            // Her film iÃ§in bir sekme oluÅŸturmak yerine, benzersiz film adlarÄ±nÄ± kullan
            const uniqueFilmNames = [...new Set(films.map(film => film.name))];
            
            uniqueFilmNames.forEach(filmName => {
                const film = films.find(f => f.name === filmName);
                if (film) {
                    const tab = document.createElement('button');
                    tab.className = 'film-tab px-6 py-3 text-gray-700 whitespace-nowrap';
                    tab.textContent = film.name;
                    tab.dataset.tab = film.id;
                    filmTabsContainer.appendChild(tab);
                }
            });
        }

        // Filmleri render et
        function renderFilms(filterId = null) {
            filmCardsContainer.innerHTML = '';
            
            let filmsToRender = contents.filter(content => content.tur === "film");
            if (filterId) {
                filmsToRender = filmsToRender.filter(film => film.id === filterId);
            }
            
            if (filmsToRender.length === 0) {
                filmCardsContainer.innerHTML = '<p class="text-gray-500 text-center py-8">HenÃ¼z film eklenmemiÅŸ.</p>';
                return;
            }
            
            filmsToRender.forEach(film => {
                // Film yorumlarÄ±nÄ± bul
                const filmComments = comments.filter(comment => comment.icerikId === film.id);
                
                // Ortalama puanÄ± hesapla
                let avgRating = 0;
                if (filmComments.length > 0) {
                    avgRating = filmComments.reduce((sum, comment) => sum + comment.puan, 0) / filmComments.length;
                }
                
                const card = createContentCard(film, avgRating, filmComments, "film");
                filmCardsContainer.appendChild(card);
            });
        }

        // KitaplarÄ± render et
        function renderBooks() {
            bookCardsContainer.innerHTML = '';
            
            const books = contents.filter(content => content.tur === "kitap");
            
            if (books.length === 0) {
                bookCardsContainer.innerHTML = '<p class="text-gray-500 text-center py-8">HenÃ¼z kitap eklenmemiÅŸ.</p>';
                return;
            }
            
            books.forEach(book => {
                // Kitap yorumlarÄ±nÄ± bul
                const bookComments = comments.filter(comment => comment.icerikId === book.id);
                
                // Ortalama puanÄ± hesapla
                let avgRating = 0;
                if (bookComments.length > 0) {
                    avgRating = bookComments.reduce((sum, comment) => sum + comment.puan, 0) / bookComments.length;
                }
                
                const card = createBookCard(book, avgRating, bookComments);
                bookCardsContainer.appendChild(card);
            });
        }

        // Ä°Ã§erik kartÄ± oluÅŸtur (film)
        function createContentCard(content, avgRating, contentComments, type) {
            const container = document.createElement('div');
            container.className = 'bg-white rounded-xl shadow-md overflow-hidden movie-card';
            
            // VarsayÄ±lan resim
            const imageUrl = content.image && content.image.trim() !== '' ? 
                content.image : 
                'https://via.placeholder.com/300x450?text=No+Image';
            
            // Kart iÃ§eriÄŸi
            const cardContent = `
                <div class="md:flex">
                    <div class="md:flex-shrink-0">
                        <div class="h-64 md:w-48 bg-purple-100 relative">
                            <img src="${imageUrl}" alt="${content.name}" class="w-full h-full object-cover">
                            <div class="absolute top-2 right-2 bg-purple-600 text-white rounded-full px-2 py-1 text-sm font-semibold">
                                ${avgRating > 0 ? avgRating.toFixed(1) : 'N/A'}
                            </div>
                        </div>
                    </div>
                    <div class="p-6 flex flex-col justify-between">
                        <div>
                            <h3 class="text-2xl font-semibold text-gray-800">${content.name}</h3>
                            <p class="text-gray-600 mt-1">${content.year || ''}</p>
                            ${content.author ? `<p class="text-purple-600 mt-1 font-medium">Yazar: ${content.author}</p>` : ''}
                            ${content.tarih_araligi ? `<p class="text-purple-600 mt-1 font-medium">${content.tarih_araligi}</p>` : ''}
                        </div>
                        <div class="mt-6 flex justify-between items-center">
                            <span class="text-sm text-gray-500 md:mr-8">${contentComments.length} yorum</span>
                            <div class="flex space-x-2">
                                ${currentUser ? 
                                    `<button class="add-comment-btn px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition" 
                                        data-id="${content.id}" 
                                        data-title="${content.name}" 
                                        data-type="${type}">
                                        Yorum Ekle
                                    </button>` : 
                                    `<button class="px-4 py-2 bg-gray-400 text-white rounded-lg cursor-not-allowed">
                                        Yorum iÃ§in GiriÅŸ YapÄ±n
                                    </button>`
                                }
                                <button class="toggle-details px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition" data-id="${content.id}">
                                    YorumlarÄ± GÃ¶ster
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Content Details Section (Hidden by default) -->
                <div class="film-details border-t border-gray-200 p-6" id="details-${content.id}">
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-4">Yorumlar ve Puanlar</h4>
                        <div class="space-y-4" id="all-comments-${content.id}">
                            ${renderCommentsHTML(contentComments)}
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = cardContent;
            
            // Event listener'larÄ± ekle
            container.querySelector('.toggle-details').addEventListener('click', (e) => {
                const contentId = e.target.dataset.id;
                toggleContentDetails(contentId);
            });
            
            const commentBtn = container.querySelector('.add-comment-btn');
            if (commentBtn) {
                commentBtn.addEventListener('click', (e) => {
                    const contentId = e.target.dataset.id;
                    const contentTitle = e.target.dataset.title;
                    const contentType = e.target.dataset.type;
                    showCommentModal(contentId, contentTitle, contentType);
                });
            }
            
            return container;
        }

        // Kitap kartÄ± oluÅŸtur
        function createBookCard(book, avgRating, bookComments) {
            const container = document.createElement('div');
            container.className = 'bg-white rounded-xl shadow-md overflow-hidden book-card';
            
            // VarsayÄ±lan resim
            const imageUrl = book.image && book.image.trim() !== '' ? 
                book.image : 
                'https://via.placeholder.com/300x450?text=No+Image';
            
            // PDF linki kontrolÃ¼
            const hasPdf = book.pdfUrl && book.pdfUrl.trim() !== '';
            
            // Kart iÃ§eriÄŸi
            const cardContent = `
                <div class="book-card-content">
                    <div class="relative">
                        <img src="${imageUrl}" alt="${book.name}" class="w-full book-image">
                        <div class="absolute top-2 right-2 bg-purple-600 text-white rounded-full px-2 py-1 text-sm font-semibold">
                            ${avgRating > 0 ? avgRating.toFixed(1) : 'N/A'}
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">${book.name}</h3>
                        ${book.author ? `<p class="text-purple-600 font-medium mb-2">Yazar: ${book.author}</p>` : ''}
                        ${book.tarih_araligi ? `<p class="text-gray-600 mb-4">${book.tarih_araligi}</p>` : ''}
                        
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-sm text-gray-500">${bookComments.length} yorum</span>
                            ${hasPdf ? `
                                <a href="${book.pdfUrl}" target="_blank" class="pdf-download-btn inline-flex items-center text-sm text-purple-600 hover:text-purple-800">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                    </svg>
                                    PDF Ä°ndir
                                </a>
                            ` : ''}
                        </div>
                        
                        <div class="book-actions flex flex-col space-y-2">
                            ${currentUser ? 
                                `<button class="add-comment-btn w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition" 
                                    data-id="${book.id}" 
                                    data-title="${book.name}" 
                                    data-type="kitap">
                                    Yorum Ekle
                                </button>` : 
                                `<button class="w-full px-4 py-2 bg-gray-400 text-white rounded-lg cursor-not-allowed">
                                    Yorum iÃ§in GiriÅŸ YapÄ±n
                                </button>`
                            }
                            <button class="toggle-details w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition" data-id="${book.id}">
                                YorumlarÄ± GÃ¶ster
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Book Details Section (Hidden by default) -->
                <div class="book-details border-t border-gray-200 p-6" id="details-${book.id}">
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-4">Yorumlar ve Puanlar</h4>
                        <div class="space-y-4" id="all-comments-${book.id}">
                            ${renderCommentsHTML(bookComments)}
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = cardContent;
            
            // Event listener'larÄ± ekle
            container.querySelector('.toggle-details').addEventListener('click', (e) => {
                const contentId = e.target.dataset.id;
                toggleContentDetails(contentId);
            });
            
            const commentBtn = container.querySelector('.add-comment-btn');
            if (commentBtn) {
                commentBtn.addEventListener('click', (e) => {
                    const contentId = e.target.dataset.id;
                    const contentTitle = e.target.dataset.title;
                    const contentType = e.target.dataset.type;
                    showCommentModal(contentId, contentTitle, contentType);
                });
            }
            
            return container;
        }

        // YorumlarÄ± HTML olarak render et
        function renderCommentsHTML(contentComments) {
            if (!contentComments || contentComments.length === 0) {
                return '<p class="text-gray-500">HenÃ¼z yorum yapÄ±lmamÄ±ÅŸ.</p>';
            }
            
            // YorumlarÄ± tarihe gÃ¶re sÄ±rala (en yeniden en eskiye)
            const sortedComments = [...contentComments].sort((a, b) => {
                return new Date(b.timestamp) - new Date(a.timestamp);
            });
            
            return sortedComments.map(comment => {
                const isVerified = comment.verified === true;
                const commentClass = isVerified ? 'featured-comment rounded-lg p-4' : 'bg-gray-50 rounded-lg p-4';
                const verifiedBadge = isVerified ? 
                    `<img src="${verifiedBadgeUrl}" alt="Verified" class="verified-badge ml-1">` : '';
                
                const formattedDate = comment.timestamp instanceof Date ? 
                    comment.timestamp.toLocaleDateString('tr-TR') : 
                    new Date(comment.timestamp).toLocaleDateString('tr-TR');
                
                return `
                    <div class="${commentClass}" data-comment-id="${comment.id}">
                        <div class="flex justify-between items-start">
                            <div>
                                <h5 class="font-semibold text-gray-800 flex items-center">
                                    ${comment.userName || 'Anonim'}
                                    ${verifiedBadge}
                                </h5>
                                <span class="text-xs text-gray-500">${formattedDate}</span>
                            </div>
                            <div class="flex items-center">
                                <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                </svg>
                                <span class="ml-1 text-gray-700">${comment.puan}/10</span>
                            </div>
                        </div>
                        <p class="mt-2 text-gray-600">${comment.yorum || ''}</p>
                    </div>
                `;
            }).join('');
        }

        // Ä°Ã§erik detaylarÄ±nÄ± gÃ¶ster/gizle
        function toggleContentDetails(contentId) {
            const detailsSection = document.getElementById(`details-${contentId}`);
            const toggleButton = document.querySelector(`.toggle-details[data-id="${contentId}"]`);
            
            if (detailsSection.classList.contains('active')) {
                detailsSection.classList.remove('active');
                toggleButton.textContent = 'YorumlarÄ± GÃ¶ster';
            } else {
                detailsSection.classList.add('active');
                toggleButton.textContent = 'YorumlarÄ± Gizle';
            }
        }

        // KullanÄ±cÄ± profilini render et
        function renderUserProfile() {
            if (!currentUser) return;
            
            // Profil resmi
            let profileImage = defaultMaleImage;
            if (currentUser.gender === "KadÄ±n") {
                profileImage = defaultFemaleImage;
            }
            
            document.getElementById('profile-image').src = profileImage;
            document.getElementById('profile-name').textContent = currentUser.name;
            document.getElementById('profile-email').textContent = `Email: ${currentUser.email}`;
            document.getElementById('profile-gender').textContent = `Cinsiyet: ${currentUser.gender || 'BelirtilmemiÅŸ'}`;
            document.getElementById('profile-age').textContent = `YaÅŸ: ${currentUser.age || 'BelirtilmemiÅŸ'}`;
            
            const createdDate = currentUser.createdAt instanceof Date ? 
                currentUser.createdAt.toLocaleDateString('tr-TR') : 
                new Date().toLocaleDateString('tr-TR');
            
            document.getElementById('profile-date').textContent = `KayÄ±t Tarihi: ${createdDate}`;
            
            // KullanÄ±cÄ± yorumlarÄ±nÄ± gÃ¶ster
            const userCommentsContainer = document.getElementById('user-comments');
            userCommentsContainer.innerHTML = '';
            
            const userComments = comments.filter(comment => comment.userId === currentUser.id);
            
            if (userComments.length === 0) {
                userCommentsContainer.innerHTML = '<p class="text-gray-500">HenÃ¼z yorum yapmadÄ±nÄ±z.</p>';
            } else {
                userComments.forEach(comment => {
                    const content = contents.find(c => c.id === comment.icerikId);
                    const contentName = content ? content.name : 'Bilinmeyen Ä°Ã§erik';
                    const contentType = comment.icerikTuru === 'film' ? 'Film' : 'Kitap';
                    
                    const formattedDate = comment.timestamp instanceof Date ? 
                        comment.timestamp.toLocaleDateString('tr-TR') : 
                        new Date(comment.timestamp).toLocaleDateString('tr-TR');
                    
                    const commentElement = document.createElement('div');
                    commentElement.className = 'bg-white rounded-lg shadow p-4';
                    commentElement.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h5 class="font-semibold text-gray-800">${contentName}</h5>
                                <span class="text-xs text-purple-600">${contentType}</span>
                                <span class="text-xs text-gray-500 ml-2">${formattedDate}</span>
                            </div>
                            <div class="flex items-center">
                                <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                </svg>
                                <span class="ml-1 text-gray-700">${comment.puan}/10</span>
                            </div>
                        </div>
                        <p class="mt-2 text-gray-600">${comment.yorum || ''}</p>
                    `;
                    
                    userCommentsContainer.appendChild(commentElement);
                });
            }
        }

        // Admin panelini render et
        function renderAdminPanel() {
            if (!isAdmin) return;
            
            // KullanÄ±cÄ±lar tablosunu doldur
            const adminUsersTable = document.getElementById('admin-users-table');
            adminUsersTable.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                
                const formattedDate = user.createdAt instanceof Date ? 
                    user.createdAt.toLocaleDateString('tr-TR') : 
                    new Date().toLocaleDateString('tr-TR');
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${user.ad || ''} ${user.soyad || ''}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${user.email || ''}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${user.cinsiyet || ''}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${user.yas || ''}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${user.role === 'admin' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}">
                            ${user.role || 'user'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-indigo-600 hover:text-indigo-900 mr-2 make-admin-btn ${user.role === 'admin' ? 'hidden' : ''}" data-user-id="${user.id}">Admin Yap</button>
                        <button class="text-red-600 hover:text-red-900 delete-user-btn" data-user-id="${user.id}">Sil</button>
                    </td>
                `;
                
                adminUsersTable.appendChild(row);
            });
            
            // Yorumlar tablosunu doldur
            const adminCommentsTable = document.getElementById('admin-comments-table');
            adminCommentsTable.innerHTML = '';
            
            comments.forEach(comment => {
                const row = document.createElement('tr');
                
                const content = contents.find(c => c.id === comment.icerikId);
                const contentName = content ? content.name : 'Bilinmeyen Ä°Ã§erik';
                
                const formattedDate = comment.timestamp instanceof Date ? 
                    comment.timestamp.toLocaleDateString('tr-TR') : 
                    new Date(comment.timestamp).toLocaleDateString('tr-TR');
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${comment.userName || 'Anonim'}</div>
                        <div class="text-xs text-gray-500">${comment.userEmail || ''}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${contentName}</div>
                        <div class="text-xs text-gray-500">${comment.icerikTuru === 'film' ? 'Film' : 'Kitap'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${comment.puan}/10</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-900 max-w-xs truncate">${comment.yorum || ''}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${formattedDate}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <input type="checkbox" class="toggle-verified-checkbox" data-comment-id="${comment.id}" ${comment.verified ? 'checked' : ''}>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-red-600 hover:text-red-900 delete-comment-btn" data-comment-id="${comment.id}">Sil</button>
                    </td>
                `;
                
                adminCommentsTable.appendChild(row);
            });
            
            // Admin butonlarÄ±na event listener'lar ekle
            document.querySelectorAll('.make-admin-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const userId = e.target.dataset.userId;
                    makeUserAdmin(userId);
                });
            });
            
            document.querySelectorAll('.delete-user-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const userId = e.target.dataset.userId;
                    deleteUser(userId);
                });
            });
            
            document.querySelectorAll('.toggle-verified-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const commentId = e.target.dataset.commentId;
                    toggleCommentVerification(commentId, e.target.checked);
                });
            });
            
            document.querySelectorAll('.delete-comment-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const commentId = e.target.dataset.commentId;
                    deleteComment(commentId);
                });
            });
        }

        // KullanÄ±cÄ±yÄ± admin yap
        function makeUserAdmin(userId) {
            if (!confirm("Bu kullanÄ±cÄ±yÄ± admin yapmak istediÄŸinize emin misiniz?")) {
                return;
            }
            
            showLoading();
            
            db.collection('users').doc(userId).update({
                role: 'admin'
            })
            .then(() => {
                // KullanÄ±cÄ± listesini gÃ¼ncelle
                const userIndex = users.findIndex(u => u.id === userId);
                if (userIndex !== -1) {
                    users[userIndex].role = 'admin';
                }
                
                renderAdminPanel();
                hideLoading();
            })
            .catch(error => {
                console.error("Admin yapma hatasÄ±:", error);
                hideLoading();
            });
        }

        // KullanÄ±cÄ±yÄ± sil
        function deleteUser(userId) {
            if (!confirm("Bu kullanÄ±cÄ±yÄ± silmek istediÄŸinize emin misiniz?")) {
                return;
            }
            
            showLoading();
            
            // KullanÄ±cÄ±nÄ±n yorumlarÄ±nÄ± sil
            db.collection('yorumlar').where('userId', '==', userId).get()
                .then(snapshot => {
                    const batch = db.batch();
                    
                    snapshot.forEach(doc => {
                        batch.delete(doc.ref);
                    });
                    
                    return batch.commit();
                })
                .then(() => {
                    // KullanÄ±cÄ±yÄ± sil
                    return db.collection('users').doc(userId).delete();
                })
                .then(() => {
                    // KullanÄ±cÄ± listesini gÃ¼ncelle
                    users = users.filter(u => u.id !== userId);
                    
                    // Yorum listesini gÃ¼ncelle
                    comments = comments.filter(c => c.userId !== userId);
                    
                    renderAdminPanel();
                    hideLoading();
                })
                .catch(error => {
                    console.error("KullanÄ±cÄ± silme hatasÄ±:", error);
                    hideLoading();
                });
        }

        // Yorum doÄŸrulamasÄ±nÄ± deÄŸiÅŸtir
        function toggleCommentVerification(commentId, isVerified) {
            showLoading();
            
            db.collection('yorumlar').doc(commentId).update({
                verified: isVerified
            })
            .then(() => {
                // Yorum listesini gÃ¼ncelle
                const commentIndex = comments.findIndex(c => c.id === commentId);
                if (commentIndex !== -1) {
                    comments[commentIndex].verified = isVerified;
                }
                
                renderAdminPanel();
                hideLoading();
            })
            .catch(error => {
                console.error("Yorum doÄŸrulama hatasÄ±:", error);
                hideLoading();
            });
        }

        // Yorumu sil
        function deleteComment(commentId) {
            if (!confirm("Bu yorumu silmek istediÄŸinize emin misiniz?")) {
                return;
            }
            
            showLoading();
            
            db.collection('yorumlar').doc(commentId).delete()
                .then(() => {
                    // Yorum listesini gÃ¼ncelle
                    comments = comments.filter(c => c.id !== commentId);
                    
                    renderAdminPanel();
                    hideLoading();
                })
                .catch(error => {
                    console.error("Yorum silme hatasÄ±:", error);
                    hideLoading();
                });
        }

        // Yorum modalÄ±nÄ± gÃ¶ster
        function showCommentModal(contentId, contentTitle, contentType) {
            document.getElementById('comment-content-id').value = contentId;
            document.getElementById('comment-content-title').value = contentTitle;
            document.getElementById('comment-content-type').value = contentType;
            document.getElementById('comment-modal-title').textContent = `${contentTitle} iÃ§in Yorum Ekle`;
            
            // YÄ±ldÄ±z derecelendirmesini sÄ±fÄ±rla
            updateStarRating(5);
            
            showModal('comment-modal');
        }

        // YÄ±ldÄ±z derecelendirmesini gÃ¼ncelle
        function updateStarRating(rating) {
            document.querySelectorAll('.rating-input label svg').forEach(star => {
                star.classList.remove('filled');
                star.classList.add('empty');
            });
            
            for (let i = 1; i <= rating; i++) {
                const star = document.querySelector(`label[for="rating-${i}"] svg`);
                if (star) {
                    star.classList.remove('empty');
                    star.classList.add('filled');
                }
            }
        }

        // Yorum ekle
        function addComment(contentId, contentTitle, contentType, rating, comment, watched) {
            if (!currentUser) {
                alert("Yorum yapmak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z.");
                return;
            }
            
            showLoading();
            
            // Yeni yorum oluÅŸtur
            const newComment = {
                icerikId: contentId,
                icerikBasligi: contentTitle,
                icerikTuru: contentType,
                puan: parseInt(rating),
                yorum: comment,
                watched: watched,
                userId: auth.currentUser.uid,
                userEmail: currentUser.email,
                userName: currentUser.name,
                verified: false,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            db.collection('yorumlar').add(newComment)
                .then(docRef => {
                    // Yeni yorumu listeye ekle
                    comments.push({
                        id: docRef.id,
                        ...newComment,
                        timestamp: new Date()
                    });
                    
                    // ModalÄ± kapat
                    hideModal('comment-modal');
                    
                    // Ä°Ã§eriÄŸi yeniden render et
                    if (contentType === 'film') {
                        renderFilms();
                    } else {
                        renderBooks();
                    }
                    
                    hideLoading();
                })
                .catch(error => {
                    console.error("Yorum ekleme hatasÄ±:", error);
                    document.getElementById('comment-error').textContent = error.message;
                    document.getElementById('comment-error').classList.remove('hidden');
                    hideLoading();
                });
        }

        // Film ekle
        function addFilm(name, year, image, dateRange) {
            if (!isAdmin) {
                alert("Film eklemek iÃ§in admin yetkisine sahip olmalÄ±sÄ±nÄ±z.");
                return;
            }
            
            showLoading();
            
            // Film ID'sini oluÅŸtur
            const filmId = `film_${name.replace(/\s+/g, '')}`;
            
            // Yeni film oluÅŸtur
            const newFilm = {
                name: name,
                tur: "film",
                year: year,
                image: image,
                tarih_araligi: dateRange,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            db.collection('icerikler').doc(filmId).set(newFilm)
                .then(() => {
                    // Yeni filmi listeye ekle
                    contents.push({
                        id: filmId,
                        ...newFilm
                    });
                    
                    // ModalÄ± kapat
                    hideModal('add-film-modal');
                    
                    // Filmleri yeniden render et
                    renderFilmTabs();
                    renderFilms();
                    
                    hideLoading();
                })
                .catch(error => {
                    console.error("Film ekleme hatasÄ±:", error);
                    document.getElementById('add-film-error').textContent = error.message;
                    document.getElementById('add-film-error').classList.remove('hidden');
                    hideLoading();
                });
        }

        // Kitap ekle
        function addBook(name, author, image, dateRange, pdfUrl) {
            if (!isAdmin) {
                alert("Kitap eklemek iÃ§in admin yetkisine sahip olmalÄ±sÄ±nÄ±z.");
                return;
            }
            
            showLoading();
            
            // Kitap ID'sini oluÅŸtur
            const bookId = `kitap_${name.replace(/\s+/g, '')}`;
            
            // Yeni kitap oluÅŸtur
            const newBook = {
                name: name,
                tur: "kitap",
                author: author,
                image: image,
                pdfUrl: pdfUrl,
                tarih_araligi: dateRange,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            db.collection('icerikler').doc(bookId).set(newBook)
                .then(() => {
                    // Yeni kitabÄ± listeye ekle
                    contents.push({
                        id: bookId,
                        ...newBook
                    });
                    
                    // ModalÄ± kapat
                    hideModal('add-book-modal');
                    
                    // KitaplarÄ± yeniden render et
                    renderBooks();
                    
                    hideLoading();
                })
                .catch(error => {
                    console.error("Kitap ekleme hatasÄ±:", error);
                    document.getElementById('add-book-error').textContent = error.message;
                    document.getElementById('add-book-error').classList.remove('hidden');
                    hideLoading();
                });
        }

        // BÃ¶lÃ¼m deÄŸiÅŸtir
        function switchSection(section) {
            filmsSection.classList.add('hidden');
            booksSection.classList.add('hidden');
            musicSection.classList.add('hidden');
            profileSection.classList.add('hidden');
            adminSection.classList.add('hidden');
            
            if (section === 'films') {
                filmsSection.classList.remove('hidden');
            } else if (section === 'books') {
                booksSection.classList.remove('hidden');
            } else if (section === 'music') {
                musicSection.classList.remove('hidden');
            } else if (section === 'profile') {
                profileSection.classList.remove('hidden');
            } else if (section === 'admin') {
                adminSection.classList.remove('hidden');
            }
        }

        // Film sekmelerini filtrele
        function filterFilms(tab) {
            // Aktif sekmeyi gÃ¼ncelle
            document.querySelectorAll('.film-tab').forEach(t => {
                t.classList.remove('tab-active');
            });
            tab.classList.add('tab-active');
            
            if (tab.dataset.tab === 'all') {
                renderFilms();
            } else {
                renderFilms(tab.dataset.tab);
            }
        }

        // ModalÄ± gÃ¶ster
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('opacity-0', 'pointer-events-none');
            document.body.classList.add('modal-active');
        }

        // ModalÄ± gizle
        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('opacity-0', 'pointer-events-none');
            document.body.classList.remove('modal-active');
            
            // Form hatalarÄ±nÄ± temizle
            const errorElement = modal.querySelector('[id$="-error"]');
            if (errorElement) {
                errorElement.classList.add('hidden');
                errorElement.textContent = '';
            }
            
            // Formu sÄ±fÄ±rla
            const form = modal.querySelector('form');
            if (form) form.reset();
        }

        // Loading gÃ¶ster
        function showLoading() {
            loadingIndicator.classList.remove('hidden');
        }

        // Loading gizle
        function hideLoading() {
            loadingIndicator.classList.add('hidden');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'965f1db9f068db87',t:'MTc1MzY1MDU0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
